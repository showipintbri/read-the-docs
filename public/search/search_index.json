{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"cisco/","text":"Cisco Links a references to things I don't want to lose again.","title":"Cisco"},{"location":"cisco/#cisco","text":"Links a references to things I don't want to lose again.","title":"Cisco"},{"location":"cisco/forensics/","text":"Cisco Forensics Collection of tools, links, techniques and resources to perform forensics on a Cisco Device. Core Dump You'll Need: - Console Cable - Network Cable - TFTP Server / FTP Server Software ([https://pjo2.github.io/tftpd64/])(https://pjo2.github.io/tftpd64/) Using a laptop or computer connect to the device with both a console cable and a regular ethernet cable. You will issue commands and capture logs from the console while the network cable will be used to off-load the core dumps and memory dumps off the device and onto a TFTP server. Step 1: Capture The Core Dump Log into the device via the console cable and issue the write core [ip.add.re.ss] command using the IP of your workstation as the destination device. Getting a Core Dump from a Cisco3560CX took: ~35 minutes and was ~528MB Switch> Switch> enable Switch# Switch# write core xx.xx.xx.1 Base name of core files to write [Switch-core]? writing uncompressed tftp://xx.xx.xx.1/Switch-corecoredump !!!!!!!!!!!!!!!!!!!! [...OMITTED...] References: Creating Core Dumps: https://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/ios-software-releases-122-mainline/12687-appA.html Didier Stevens: NAFT - https://blog.didierstevens.com/programs/network-appliance-forensic-toolkit/ SANS: Cisco Router Forensics - https://www.sans.org/blog/cisco-router-forensics/","title":"Forensics"},{"location":"cisco/forensics/#cisco-forensics","text":"Collection of tools, links, techniques and resources to perform forensics on a Cisco Device.","title":"Cisco Forensics"},{"location":"cisco/forensics/#core-dump","text":"You'll Need: - Console Cable - Network Cable - TFTP Server / FTP Server Software ([https://pjo2.github.io/tftpd64/])(https://pjo2.github.io/tftpd64/) Using a laptop or computer connect to the device with both a console cable and a regular ethernet cable. You will issue commands and capture logs from the console while the network cable will be used to off-load the core dumps and memory dumps off the device and onto a TFTP server.","title":"Core Dump"},{"location":"cisco/forensics/#step-1-capture-the-core-dump","text":"Log into the device via the console cable and issue the write core [ip.add.re.ss] command using the IP of your workstation as the destination device. Getting a Core Dump from a Cisco3560CX took: ~35 minutes and was ~528MB Switch> Switch> enable Switch# Switch# write core xx.xx.xx.1 Base name of core files to write [Switch-core]? writing uncompressed tftp://xx.xx.xx.1/Switch-corecoredump !!!!!!!!!!!!!!!!!!!! [...OMITTED...] References: Creating Core Dumps: https://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/ios-software-releases-122-mainline/12687-appA.html Didier Stevens: NAFT - https://blog.didierstevens.com/programs/network-appliance-forensic-toolkit/ SANS: Cisco Router Forensics - https://www.sans.org/blog/cisco-router-forensics/","title":"Step 1: Capture The Core Dump"},{"location":"cloudflare/","text":"Cloudflare Zero-Trust cloudflared Cloudflared (cloud-flare-dee) is a light weight multi-purpose daemon. It can be invoked manually or through scripting/service files to manage tunnels. You can run many instances of cloudflared at once if needed. For example, I run one instance acting as a DNS to DNS over HTTPS proxy and another instance as a tunnel to reach the webserver on that box which is listening on localhost. Example cloudflared service file for DNS to DNS over HTTPS Proxy [Unit] Description=DNS over HTTPS (DoH) proxy client Wants=network-online.target nss-lookup.target Before=nss-lookup.target [Service] AmbientCapabilities=CAP_NET_BIND_SERVICE CapabilityBoundingSet=CAP_NET_BIND_SERVICE TimeoutStartSec=0 Type=notify ExecStart=/usr/bin/cloudflared --no-autoupdate proxy-dns --address \"localhost\" --port 5053 --upstream \"https://x0x0x0x0x.cloudflare-gateway.com/dns-query\" --bootstrap \"https://1.1.1.1/dns-query\", \"https://1.0.0.1/dns-query\" Restart=on-failure RestartSec=5s [Install] WantedBy=multi-user.target","title":"Cloudflare Zero-Trust"},{"location":"cloudflare/#cloudflare-zero-trust","text":"","title":"Cloudflare Zero-Trust"},{"location":"cloudflare/#cloudflared","text":"Cloudflared (cloud-flare-dee) is a light weight multi-purpose daemon. It can be invoked manually or through scripting/service files to manage tunnels. You can run many instances of cloudflared at once if needed. For example, I run one instance acting as a DNS to DNS over HTTPS proxy and another instance as a tunnel to reach the webserver on that box which is listening on localhost.","title":"cloudflared"},{"location":"cloudflare/#example-cloudflared-service-file-for-dns-to-dns-over-https-proxy","text":"[Unit] Description=DNS over HTTPS (DoH) proxy client Wants=network-online.target nss-lookup.target Before=nss-lookup.target [Service] AmbientCapabilities=CAP_NET_BIND_SERVICE CapabilityBoundingSet=CAP_NET_BIND_SERVICE TimeoutStartSec=0 Type=notify ExecStart=/usr/bin/cloudflared --no-autoupdate proxy-dns --address \"localhost\" --port 5053 --upstream \"https://x0x0x0x0x.cloudflare-gateway.com/dns-query\" --bootstrap \"https://1.1.1.1/dns-query\", \"https://1.0.0.1/dns-query\" Restart=on-failure RestartSec=5s [Install] WantedBy=multi-user.target","title":"Example cloudflared service file for DNS to DNS over HTTPS Proxy"},{"location":"credentials/","text":"Default Credentials Dell S4112F-ON - OS10: admin / admin GigaVUE-OS: admin / admin123A!","title":"Default Credentials"},{"location":"credentials/#default-credentials","text":"Dell S4112F-ON - OS10: admin / admin GigaVUE-OS: admin / admin123A!","title":"Default Credentials"},{"location":"docker-podman/","text":"Docker/Podman This page is dedicated to all things containers :) I use docker and podman interchangeably. Run a Container -i : interactive -t : terminal -v [src]:[dst] : mounting a storage volume Example: Starting my Zeek(bro) container sudo docker run -it -v `pwd`:/pcap broplatform/bro:4.2.0 /bin/bash List Running Containers podman container list Get Container Details podman inspect [container_name] References: Official Podman Documentation: https://docs.podman.io/en/latest/index.html","title":"Docker/Podman"},{"location":"docker-podman/#dockerpodman","text":"This page is dedicated to all things containers :) I use docker and podman interchangeably.","title":"Docker/Podman"},{"location":"docker-podman/#run-a-container","text":"-i : interactive -t : terminal -v [src]:[dst] : mounting a storage volume Example: Starting my Zeek(bro) container sudo docker run -it -v `pwd`:/pcap broplatform/bro:4.2.0 /bin/bash","title":"Run a Container"},{"location":"docker-podman/#list-running-containers","text":"podman container list","title":"List Running Containers"},{"location":"docker-podman/#get-container-details","text":"podman inspect [container_name] References: Official Podman Documentation: https://docs.podman.io/en/latest/index.html","title":"Get Container Details"},{"location":"elk/","text":"Elasticsearch / Logstash / Kibana Elasticsearch API w/CURL tcp/9200 is the default port. HTTP: curl http://localhost:9200 If you get an error: curl: (52) Empty reply from server this likely means you need to use https . HTTPS: curl https://localhost:9200 If you get an error about trusted certificates you can use the -k flag to tell CURL to ignore untrusted certificates. HTTPS, Ignore Untrusted Certificates: curl -k https://localhost:9200 If you get an error about the 'security realm', you'll need to add HTTP Basic Authentication to your command. HTTPS, Ignore Untrusted Certificates w/Authentication: curl -k -u elastic:[password] https://localhost:9200 List Indexes: curl -k -u elastic:[password] -XGET \"https://localhost:9200/_aliases?pretty=true\" Delete Index: curl -k -u elastic:[password] -XDELETE \"https://localhost:9200/[explicit_index_name]\" References: https://linuxhint.com/elasticsearch-delete-index-how-to/ Troubleshooting Error: \"high watermark\" Your storage is full beyond the configured \"high watermark\" (90%?). You need to manually delete indices. List your indexes (wildcards accepted) Delete individual indexes (wildcards NOT accepted)","title":"Elasticsearch / Logstash / Kibana"},{"location":"elk/#elasticsearch-logstash-kibana","text":"","title":"Elasticsearch / Logstash / Kibana"},{"location":"elk/#elasticsearch-api-wcurl","text":"tcp/9200 is the default port. HTTP: curl http://localhost:9200 If you get an error: curl: (52) Empty reply from server this likely means you need to use https . HTTPS: curl https://localhost:9200 If you get an error about trusted certificates you can use the -k flag to tell CURL to ignore untrusted certificates. HTTPS, Ignore Untrusted Certificates: curl -k https://localhost:9200 If you get an error about the 'security realm', you'll need to add HTTP Basic Authentication to your command. HTTPS, Ignore Untrusted Certificates w/Authentication: curl -k -u elastic:[password] https://localhost:9200 List Indexes: curl -k -u elastic:[password] -XGET \"https://localhost:9200/_aliases?pretty=true\" Delete Index: curl -k -u elastic:[password] -XDELETE \"https://localhost:9200/[explicit_index_name]\"","title":"Elasticsearch API w/CURL"},{"location":"elk/#references","text":"https://linuxhint.com/elasticsearch-delete-index-how-to/","title":"References:"},{"location":"elk/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"elk/#error-high-watermark","text":"Your storage is full beyond the configured \"high watermark\" (90%?). You need to manually delete indices. List your indexes (wildcards accepted) Delete individual indexes (wildcards NOT accepted)","title":"Error: \"high watermark\""},{"location":"git/","text":"Git The simplest Git workflow Init --> Add --> Commit --> Push Create a local repo Add all files from your current directory to Git Commit those files/changes Push those changes to the repo git init . git add . git commit -m \"New Files Added\" git push Clone Remote Repository git clone https://github.com/ntop/nDPI.git Clone a Specific Branch from Remote Repository NOTE: Still fetches all the branches but marks the one you specify as active. git clone --branch 4.2-stable https://github.com/ntop/nDPI.git Clone a Specific Branch and Only that Branch from a Remote Repo git clone -b 4.2-stable --single-branch https://github.com/ntop/nDPI.git","title":"Git"},{"location":"git/#git","text":"","title":"Git"},{"location":"git/#the-simplest-git-workflow","text":"Init --> Add --> Commit --> Push Create a local repo Add all files from your current directory to Git Commit those files/changes Push those changes to the repo git init . git add . git commit -m \"New Files Added\" git push","title":"The simplest Git workflow"},{"location":"git/#clone-remote-repository","text":"git clone https://github.com/ntop/nDPI.git","title":"Clone Remote Repository"},{"location":"git/#clone-a-specific-branch-from-remote-repository","text":"NOTE: Still fetches all the branches but marks the one you specify as active. git clone --branch 4.2-stable https://github.com/ntop/nDPI.git","title":"Clone a Specific Branch from Remote Repository"},{"location":"git/#clone-a-specific-branch-and-only-that-branch-from-a-remote-repo","text":"git clone -b 4.2-stable --single-branch https://github.com/ntop/nDPI.git","title":"Clone a Specific Branch and Only that Branch from a Remote Repo"},{"location":"graylog/","text":"Graylog My collection of Graylog tips, tricks, warnings, cautions and lessons learned.","title":"Graylog"},{"location":"graylog/#graylog","text":"My collection of Graylog tips, tricks, warnings, cautions and lessons learned.","title":"Graylog"},{"location":"graylog/field_names/","text":"Field Names Do Not Use: syslog_* Recently when building some parsers I was receiving a log like this on a \"Plain Text/RAW\" input. <27>Nov 29 15:05:42 blah blah blah msg msg msg I was trying to parse out the number from between the left and right arrows, which is the Syslog Priority value and put it in a field named: syslog_priority . This wasn't working. After hours of futtsing with it, it was determined that the cause of the failures was when I started a field name with syslog_ . I tested and tested and got the same results with each test: any time syslog_ was in the field name the pipeline rule wouldn't work. Assumption: I'm sure this is because how syslog messages are recieved and processed under the hood, but I can not confirm that. Troubleshooting Blank White Login Page When navigating to the WebGUI and greeted by a blank white page when the system otherwise seems stable: SSH into the system make sure the services are running as expected Check logs for errors Errors Seen: java.nio.file.FileSystemNotFoundException: /usr/share/graylog-server/plugin/graylog-plugin-enterprise-4.2.1.jar When you, ls /usr/share/graylog-server/plugin/ , the files throwing the error aren't there. Try removing the enterprise plug-in assuming you aren't using the enterprise features : yum remove graylog-enterprise-plugins","title":"Field Names"},{"location":"graylog/field_names/#field-names","text":"Do Not Use: syslog_* Recently when building some parsers I was receiving a log like this on a \"Plain Text/RAW\" input. <27>Nov 29 15:05:42 blah blah blah msg msg msg I was trying to parse out the number from between the left and right arrows, which is the Syslog Priority value and put it in a field named: syslog_priority . This wasn't working. After hours of futtsing with it, it was determined that the cause of the failures was when I started a field name with syslog_ . I tested and tested and got the same results with each test: any time syslog_ was in the field name the pipeline rule wouldn't work. Assumption: I'm sure this is because how syslog messages are recieved and processed under the hood, but I can not confirm that.","title":"Field Names"},{"location":"graylog/field_names/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"graylog/field_names/#blank-white-login-page","text":"When navigating to the WebGUI and greeted by a blank white page when the system otherwise seems stable: SSH into the system make sure the services are running as expected Check logs for errors Errors Seen: java.nio.file.FileSystemNotFoundException: /usr/share/graylog-server/plugin/graylog-plugin-enterprise-4.2.1.jar When you, ls /usr/share/graylog-server/plugin/ , the files throwing the error aren't there. Try removing the enterprise plug-in assuming you aren't using the enterprise features : yum remove graylog-enterprise-plugins","title":"Blank White Login Page"},{"location":"juniper/","text":"Juniper My collection of Juniper stuff that I commonly forget. Default Configuration switch# load factory-default switch# delete system commit switch# commit NOTE: You might need to set a root-authentication before issuing the final commit. Reference: https://www.juniper.net/documentation/us/en/software/junos/cli/topics/topic-map/junos-factory-default.html Create VLAN set vlans [name] vlan-id [##] Example: set vlans v30-Engineering vlan-id 30 Create VLAN Interface (L3) set interfaces vlan unit [##] family inet address [address/mask]] set vlans [name] l3-interface vlan.[##] Example: set interfaces vlan unit 30 family inet address 10.30.30.254/24 set vlans v30-Engineering l3-interface vlan.30 Switchport: Access set interfaces [interface] unit 0 family ethernet-switching port-mode access set interfaces [interface] unit 0 family ethernet-switching vlan members [vlan-name] Example: set interfaces ge-0/0/47 description \"Access: Engineering Desk-002\" set interfaces ge-0/0/47 unit 0 family ethernet-switching port-mode access set interfaces ge-0/0/47 unit 0 family ethernet-switching vlan members v30-Engineering Switchport: Trunk set interfaces [interface] unit 0 family ethernet-switching port-mode trunk set interfaces [interface] unit 0 family ethernet-switching vlan members [vlan-name] Example: set interfaces ge-0/0/1 description \"Trunk: To Engineering Dept.\" set interfaces ge-0/0/1 unit 0 family ethernet-switching port-mode trunk set interfaces ge-0/0/1 unit 0 family ethernet-switching vlan members v30-Engineering Interface Range set interfaces interface-range [range-name] member-range [start-int] to [end-int] Example: set interfaces interface-range v30-Eng-Dept member-range ge-0/0/12 to ge-0/0/46 set interfaces interface-range v30-Eng-Dept description \"Access: Engineering Department\" set interfaces interface-range v30-Eng-Dep unit 0 family ethernet-switching port-mode access set interfaces interface-range v30-Eng-Dep unit 0 family ethernet-switching vlan members v30-Engineering Static Route set routing-options static route [prefix/mask] next-hop [nh-address] Example: set routing-options static route 0.0.0.0/0 next-hop 10.30.30.1 Change root Password set system root-authentication plain-text-password New password: [input-password] <enter> Retype new password: [input-password] <enter> New User set system login user admin class super-user set system login user admin authentication plain-text-password <enter> New password: [input-password] <enter> Retype new password: [input-password] <enter> SSH Access set system services ssh Reboot/Restart request system reboot Shutdown request system power-off or request system halt ? Whats the difference ?","title":"Juniper"},{"location":"juniper/#juniper","text":"My collection of Juniper stuff that I commonly forget.","title":"Juniper"},{"location":"juniper/#default-configuration","text":"switch# load factory-default switch# delete system commit switch# commit NOTE: You might need to set a root-authentication before issuing the final commit. Reference: https://www.juniper.net/documentation/us/en/software/junos/cli/topics/topic-map/junos-factory-default.html","title":"Default Configuration"},{"location":"juniper/#create-vlan","text":"set vlans [name] vlan-id [##] Example: set vlans v30-Engineering vlan-id 30","title":"Create VLAN"},{"location":"juniper/#create-vlan-interface-l3","text":"set interfaces vlan unit [##] family inet address [address/mask]] set vlans [name] l3-interface vlan.[##] Example: set interfaces vlan unit 30 family inet address 10.30.30.254/24 set vlans v30-Engineering l3-interface vlan.30","title":"Create VLAN Interface (L3)"},{"location":"juniper/#switchport-access","text":"set interfaces [interface] unit 0 family ethernet-switching port-mode access set interfaces [interface] unit 0 family ethernet-switching vlan members [vlan-name] Example: set interfaces ge-0/0/47 description \"Access: Engineering Desk-002\" set interfaces ge-0/0/47 unit 0 family ethernet-switching port-mode access set interfaces ge-0/0/47 unit 0 family ethernet-switching vlan members v30-Engineering","title":"Switchport: Access"},{"location":"juniper/#switchport-trunk","text":"set interfaces [interface] unit 0 family ethernet-switching port-mode trunk set interfaces [interface] unit 0 family ethernet-switching vlan members [vlan-name] Example: set interfaces ge-0/0/1 description \"Trunk: To Engineering Dept.\" set interfaces ge-0/0/1 unit 0 family ethernet-switching port-mode trunk set interfaces ge-0/0/1 unit 0 family ethernet-switching vlan members v30-Engineering","title":"Switchport: Trunk"},{"location":"juniper/#interface-range","text":"set interfaces interface-range [range-name] member-range [start-int] to [end-int] Example: set interfaces interface-range v30-Eng-Dept member-range ge-0/0/12 to ge-0/0/46 set interfaces interface-range v30-Eng-Dept description \"Access: Engineering Department\" set interfaces interface-range v30-Eng-Dep unit 0 family ethernet-switching port-mode access set interfaces interface-range v30-Eng-Dep unit 0 family ethernet-switching vlan members v30-Engineering","title":"Interface Range"},{"location":"juniper/#static-route","text":"set routing-options static route [prefix/mask] next-hop [nh-address] Example: set routing-options static route 0.0.0.0/0 next-hop 10.30.30.1","title":"Static Route"},{"location":"juniper/#change-root-password","text":"set system root-authentication plain-text-password New password: [input-password] <enter> Retype new password: [input-password] <enter>","title":"Change root Password"},{"location":"juniper/#new-user","text":"set system login user admin class super-user set system login user admin authentication plain-text-password <enter> New password: [input-password] <enter> Retype new password: [input-password] <enter>","title":"New User"},{"location":"juniper/#ssh-access","text":"set system services ssh","title":"SSH Access"},{"location":"juniper/#rebootrestart","text":"request system reboot","title":"Reboot/Restart"},{"location":"juniper/#shutdown","text":"request system power-off or request system halt ? Whats the difference ?","title":"Shutdown"},{"location":"linux/","text":"Linux This page contains many linux one-liners, or software packages or things I've needed to look up, more than once.","title":"Linux"},{"location":"linux/#linux","text":"This page contains many linux one-liners, or software packages or things I've needed to look up, more than once.","title":"Linux"},{"location":"linux/bash/","text":"Bash Bash reminders, tips, tricks and things I've forgot. STDERR & STDOUT When using >> output.txt , it will only include STDOUT (Standard Output). To include errors with the output use: >> output.txt 2>&1 For Loop for i in $(ls *.*) do; mv $i prefix_$i; done or as a one-liner: for i in $(ls *.*) do; mv $i prefix_$i; done For Loop in Range of Numbers for i in {1..450} do wget http://sharkfest-ctf.showipintbri.com:8081/$i -O /dev/null sleep 1 done or as a one-liner: for i in {1..450}; do wget http://sharkfest-ctf.showipintbri.com:8081/$i -O /dev/null; sleep 1; done Multi-line Append cat >> /path/to/existingFile.text<< EOF some text line 1 some text line 2 some text line 3 EOF Users and Groups Create a new user useradd [options] [user_name] Assign/Change a password for a user passwd [user_name] Add a User to a Group usermod -a -G [group_name] [user_name]","title":"bash"},{"location":"linux/bash/#bash","text":"Bash reminders, tips, tricks and things I've forgot.","title":"Bash"},{"location":"linux/bash/#stderr-stdout","text":"When using >> output.txt , it will only include STDOUT (Standard Output). To include errors with the output use: >> output.txt 2>&1","title":"STDERR &amp; STDOUT"},{"location":"linux/bash/#for-loop","text":"for i in $(ls *.*) do; mv $i prefix_$i; done or as a one-liner: for i in $(ls *.*) do; mv $i prefix_$i; done","title":"For Loop"},{"location":"linux/bash/#for-loop-in-range-of-numbers","text":"for i in {1..450} do wget http://sharkfest-ctf.showipintbri.com:8081/$i -O /dev/null sleep 1 done or as a one-liner: for i in {1..450}; do wget http://sharkfest-ctf.showipintbri.com:8081/$i -O /dev/null; sleep 1; done","title":"For Loop in Range of Numbers"},{"location":"linux/bash/#multi-line-append","text":"cat >> /path/to/existingFile.text<< EOF some text line 1 some text line 2 some text line 3 EOF","title":"Multi-line Append"},{"location":"linux/bash/#users-and-groups","text":"","title":"Users and Groups"},{"location":"linux/bash/#create-a-new-user","text":"useradd [options] [user_name]","title":"Create a new user"},{"location":"linux/bash/#assignchange-a-password-for-a-user","text":"passwd [user_name]","title":"Assign/Change a password for a user"},{"location":"linux/bash/#add-a-user-to-a-group","text":"usermod -a -G [group_name] [user_name]","title":"Add a User to a Group"},{"location":"linux/centos/","text":"Centos Static IP Address Edit: /etc/sysconfig/network-scripts/ifcfg-[interface_name] TYPE=Ethernet BOOTPROTO=static NAME=eno2 UUID=a6a9b6a7-5215-4cf1-9f74-3d03559674a9 DEVICE=eno2 ONBOOT=yes IPADDR=10.13.65.246 NETMASK=255.255.255.0 GATEWAY=10.13.65.1 DNS1=1.1.1.1 DNS2=8.8.8.8 After Editing the file restart networking: sudo systemctl restart network Hostname See current hostname: hostname Edit: vi /etc/hostname Validate with: hostnamectl A restart is often required or logout of your current SSH session and log back in.","title":"CentOS"},{"location":"linux/centos/#centos","text":"","title":"Centos"},{"location":"linux/centos/#static-ip-address","text":"Edit: /etc/sysconfig/network-scripts/ifcfg-[interface_name] TYPE=Ethernet BOOTPROTO=static NAME=eno2 UUID=a6a9b6a7-5215-4cf1-9f74-3d03559674a9 DEVICE=eno2 ONBOOT=yes IPADDR=10.13.65.246 NETMASK=255.255.255.0 GATEWAY=10.13.65.1 DNS1=1.1.1.1 DNS2=8.8.8.8 After Editing the file restart networking: sudo systemctl restart network","title":"Static IP Address"},{"location":"linux/centos/#hostname","text":"See current hostname: hostname Edit: vi /etc/hostname Validate with: hostnamectl A restart is often required or logout of your current SSH session and log back in.","title":"Hostname"},{"location":"linux/ipv6/","text":"IPv6 Ubuntu: Netplan Create a new config file. Highest one takes precendence. touch /etc/netplan/99-ipv6.yaml ------------------------------- network: ethernets: ens160: dhcp6: true accept-ra: true # Host will use SLAAC to configure its address and gateway addresses: ['fd10::10/64'] #ULA address for my site nameservers: addresses: ['2606:4700:4700::1111'] #Cloudflare DNS version: 2","title":"IPv6"},{"location":"linux/ipv6/#ipv6","text":"","title":"IPv6"},{"location":"linux/ipv6/#ubuntu-netplan","text":"Create a new config file. Highest one takes precendence. touch /etc/netplan/99-ipv6.yaml ------------------------------- network: ethernets: ens160: dhcp6: true accept-ra: true # Host will use SLAAC to configure its address and gateway addresses: ['fd10::10/64'] #ULA address for my site nameservers: addresses: ['2606:4700:4700::1111'] #Cloudflare DNS version: 2","title":"Ubuntu: Netplan"},{"location":"linux/rsyslog/","text":"rsyslog rsyslog is a linux syslog software package. https://www.rsyslog.com/ Config File: /etc/rsyslog.conf start/stop/restart When starting/stopping/restarting the rsyslog service you'll sometimes be shown this error message: sudo systemctl stop rsyslog Warning: Stopping rsyslog.service, but it can still be activated by: syslog.socket Explanation: from: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=815862 As this message says, rsyslog uses socket activation under systemd. So whenever there is a log message coming in, rsyslog will be started on demand. The unit is named syslog.socket. To stop/start/restart/status: systemctl stop syslog.socket rsyslog.service systemctl start syslog.socket rsyslog.service systemctl restart syslog.socket rsyslog.service systemctl status syslog.socket rsyslog.service rsyslog.conf Reference: https://www.man7.org/linux/man-pages/man5/rsyslog.conf.5.html cat /etc/rsyslog.d/vyos-rsyslog.conf ## generated by syslog.py ## ## file based logging $outchannel global,/var/log/messages,262144,/usr/sbin/logrotate /etc/logrotate.d/vyos-rsyslog *.notice;local7.debug :omfile:$global ## console logging ## remote logging *.* @@(o)st-graylog01.stech.sealingtech.org:514;RSYSLOG_SyslogProtocol23Format Explanation: *.* : any facility . any level @ : UDP transport @@ : TCP transport (o) : Use octet-counted framing (optional) RSYSLOG_SyslogProtocol23Format : Use Protocol23Format References: - \"TCP_Framing\" https://rsyslog-doc.readthedocs.io/en/latest/configuration/modules/omfwd.html#action-parameters","title":"rsyslog"},{"location":"linux/rsyslog/#rsyslog","text":"rsyslog is a linux syslog software package. https://www.rsyslog.com/ Config File: /etc/rsyslog.conf","title":"rsyslog"},{"location":"linux/rsyslog/#startstoprestart","text":"When starting/stopping/restarting the rsyslog service you'll sometimes be shown this error message: sudo systemctl stop rsyslog Warning: Stopping rsyslog.service, but it can still be activated by: syslog.socket Explanation: from: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=815862 As this message says, rsyslog uses socket activation under systemd. So whenever there is a log message coming in, rsyslog will be started on demand. The unit is named syslog.socket.","title":"start/stop/restart"},{"location":"linux/rsyslog/#to-stopstartrestartstatus","text":"systemctl stop syslog.socket rsyslog.service systemctl start syslog.socket rsyslog.service systemctl restart syslog.socket rsyslog.service systemctl status syslog.socket rsyslog.service","title":"To stop/start/restart/status:"},{"location":"linux/rsyslog/#rsyslogconf","text":"Reference: https://www.man7.org/linux/man-pages/man5/rsyslog.conf.5.html cat /etc/rsyslog.d/vyos-rsyslog.conf ## generated by syslog.py ## ## file based logging $outchannel global,/var/log/messages,262144,/usr/sbin/logrotate /etc/logrotate.d/vyos-rsyslog *.notice;local7.debug :omfile:$global ## console logging ## remote logging *.* @@(o)st-graylog01.stech.sealingtech.org:514;RSYSLOG_SyslogProtocol23Format","title":"rsyslog.conf"},{"location":"linux/rsyslog/#explanation","text":"*.* : any facility . any level @ : UDP transport @@ : TCP transport (o) : Use octet-counted framing (optional) RSYSLOG_SyslogProtocol23Format : Use Protocol23Format References:","title":"Explanation:"},{"location":"linux/rsyslog/#-tcp_framing-httpsrsyslog-docreadthedocsioenlatestconfigurationmodulesomfwdhtmlaction-parameters","text":"","title":"- \"TCP_Framing\" https://rsyslog-doc.readthedocs.io/en/latest/configuration/modules/omfwd.html#action-parameters"},{"location":"linux/systemctl/","text":"systemctl systemctl start [unit] systemctl status [unit] systemctl stop [unit] systemctl reload [unit] systemctl restart [unit] systemctl enable [unit] systemctl disable [unit] systemctl list-units [unit] systemctl list-sockets [unit] systemctl list-unit-files [pattern] Example *.service files Service files are typically found in: /etc/systemd/system/[service_name].service Service can only have 1 ExecStart statement. [Unit] Description=cloudflared After=network.target [Service] TimeoutStartSec=0 Type=notify ExecStart=/usr/bin/cloudflared --no-autoupdate tunnel run --token x0x0x0x0x0x0x0x0x0x Restart=on-failure RestartSec=5s [Install] WantedBy=multi-user.target Show/List All Services systemctl list-units --all *.service Show Details about a Single Service systemctl status [service_name] References:","title":"systemctl"},{"location":"linux/systemctl/#systemctl","text":"systemctl start [unit] systemctl status [unit] systemctl stop [unit] systemctl reload [unit] systemctl restart [unit] systemctl enable [unit] systemctl disable [unit] systemctl list-units [unit] systemctl list-sockets [unit] systemctl list-unit-files [pattern]","title":"systemctl"},{"location":"linux/systemctl/#example-service-files","text":"Service files are typically found in: /etc/systemd/system/[service_name].service Service can only have 1 ExecStart statement. [Unit] Description=cloudflared After=network.target [Service] TimeoutStartSec=0 Type=notify ExecStart=/usr/bin/cloudflared --no-autoupdate tunnel run --token x0x0x0x0x0x0x0x0x0x Restart=on-failure RestartSec=5s [Install] WantedBy=multi-user.target","title":"Example *.service files"},{"location":"linux/systemctl/#showlist-all-services","text":"systemctl list-units --all *.service","title":"Show/List All Services"},{"location":"linux/systemctl/#show-details-about-a-single-service","text":"systemctl status [service_name]","title":"Show Details about a Single Service"},{"location":"linux/systemctl/#references","text":"","title":"References:"},{"location":"python/","text":"Python This is one location for all things python that I've had to look up, or forgotten or had a bookmark for in my browser. This is NOT intended to be the worlds single reference python resource, instead it serves me directly. If you'd like to submit a correction or contribute, PR's are welcomed. I tried to be original and unique in most of my examples and code, this was not to rip-off anyone elses examples or work. There are countless sites over the years I've used for reference and python script text files on my desktop of code I'll never remember where it all came from. Thank you to everyone who puts code and examples out there on the internet. Here's my little place to aggregate what I use and give back.","title":"Python"},{"location":"python/#python","text":"This is one location for all things python that I've had to look up, or forgotten or had a bookmark for in my browser. This is NOT intended to be the worlds single reference python resource, instead it serves me directly. If you'd like to submit a correction or contribute, PR's are welcomed. I tried to be original and unique in most of my examples and code, this was not to rip-off anyone elses examples or work. There are countless sites over the years I've used for reference and python script text files on my desktop of code I'll never remember where it all came from. Thank you to everyone who puts code and examples out there on the internet. Here's my little place to aggregate what I use and give back.","title":"Python"},{"location":"python/dictionaries/","text":"Dictionaries Dictionaries are a data structure made up of ' keys ' and ' values ' created with the use of curly-braces ' {} ' in Python. Rules: Keys must be unique. If a Key needs more than 1 Value, you must use a list, nested dictionary, tuple or other iterable. Create a Dictionary Before you can replace, update or delete any keys or values you must instantiate the dictionary. Empty dictionary: my_dict = {} Or instantiate with keys and values: my_dict = {'key1': 'value1'} or my_dict['key1'] = 'value1' You can call the object directly or print the dictionary: >>> my_dict = {'key1': 'value1'} >>> my_dict {'key1': 'value1'} Using print() : >>> my_dict = {'key1': 'value1'} >>> print(my_dict) {'key1': 'value1'} Add Key & Value to Existing Dictionary Key must be unique If Key is not unique Value will be overwritten. Start with a dictionary >>> my_dict = {'key1': 'value1'} >>> my_dict {'key1': 'value1'} Create a new Key with Value >>> my_dict['key2'] = 'value0' >>> my_dict {'key1': 'value1', 'key2': 'value0'} Update the Value for existing Key (overwrite) >>> my_dict['key2'] = 'value1' >>> my_dict {'key1': 'value1', 'key2': 'value1'} Add multiple Values to Key Because a Value is a single object, I commonly use list's when I need a Key to contain multiple Values. Convert your Key with a single value to a Key with a list object as a Value: >>> my_dict['key1'] = [my_dict['key1']] >>> my_dict {'key1': ['value1']}","title":"Dictionaries"},{"location":"python/dictionaries/#dictionaries","text":"Dictionaries are a data structure made up of ' keys ' and ' values ' created with the use of curly-braces ' {} ' in Python. Rules: Keys must be unique. If a Key needs more than 1 Value, you must use a list, nested dictionary, tuple or other iterable.","title":"Dictionaries"},{"location":"python/dictionaries/#create-a-dictionary","text":"Before you can replace, update or delete any keys or values you must instantiate the dictionary.","title":"Create a Dictionary"},{"location":"python/dictionaries/#empty-dictionary","text":"my_dict = {}","title":"Empty dictionary:"},{"location":"python/dictionaries/#or-instantiate-with-keys-and-values","text":"my_dict = {'key1': 'value1'} or my_dict['key1'] = 'value1' You can call the object directly or print the dictionary: >>> my_dict = {'key1': 'value1'} >>> my_dict {'key1': 'value1'} Using print() : >>> my_dict = {'key1': 'value1'} >>> print(my_dict) {'key1': 'value1'}","title":"Or instantiate with keys and values:"},{"location":"python/dictionaries/#add-key-value-to-existing-dictionary","text":"Key must be unique If Key is not unique Value will be overwritten.","title":"Add Key &amp; Value to Existing Dictionary"},{"location":"python/dictionaries/#start-with-a-dictionary","text":">>> my_dict = {'key1': 'value1'} >>> my_dict {'key1': 'value1'}","title":"Start with a dictionary"},{"location":"python/dictionaries/#create-a-new-key-with-value","text":">>> my_dict['key2'] = 'value0' >>> my_dict {'key1': 'value1', 'key2': 'value0'}","title":"Create a new Key with Value"},{"location":"python/dictionaries/#update-the-value-for-existing-key-overwrite","text":">>> my_dict['key2'] = 'value1' >>> my_dict {'key1': 'value1', 'key2': 'value1'}","title":"Update the Value for existing Key (overwrite)"},{"location":"python/dictionaries/#add-multiple-values-to-key","text":"Because a Value is a single object, I commonly use list's when I need a Key to contain multiple Values. Convert your Key with a single value to a Key with a list object as a Value: >>> my_dict['key1'] = [my_dict['key1']] >>> my_dict {'key1': ['value1']}","title":"Add multiple Values to Key"},{"location":"tcpdump/","text":"TCPdump Filters Filters are written in BPF (Berkley Packet Filter). CDP, VTP, PAgP, DTP, RSTP 'ether dst 01:00:0c:cc:cc:cd' EIGRP 'ether dst 01:00:5e:00:00:0a' 'host 224.0.0.10' Spanning-Tree 'stp' VLANs / 802.1q vlan Troubleshooting Continuous capture failing to write to new file sudo tcpdump -i ens160 -C 100 -w web_traffic.pcap When tcpdump writes continuous files it appends a number to the file name. If you wanted to continuously capture traffic and write it to disks in approximately 100MB files using the base filename full_capture.pcap . Once the first ~100MB is written, tcpdump will create a new file with the name: full_capture.pcap1 . This will continue, increasing the numeric value appended to the end. The conflict with the apparmor policy happens because apparmor will only allow tcpdump to write files with extensions: .pcap or .cap (in any combination of upper- and lowercase). The problem is this section of the apparmor policy: /etc/apparmor.d/usr.bin.tcpdump # for -r, -F and -w /**.[pP][cC][aA][pP] rw, /**.[cC][aA][pP] rw, We can modify the policy to allow the continuous writing of files by adding the below lines or modifying the existing lines from the config section above: # for -r, -F and -w /**.[pP][cC][aA][pP][0-9]* rw, /**.[cC][aA][pP][0-9]* rw, Solution My solution isn't to disable apparmor, but instead to modify the apparmor policy so tcpdump can do what it needs and apparmor can continue to do what it does. Commands Check the apparmor status: sudo aa-status Check the logs: cat /var/log/syslog | grep -i denied Apr 26 20:58:00 hostname-pcap kernel: [ 2169.229999] audit: type=1400 audit(1651006680.331:31): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1905 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 20:58:54 hostname-pcap kernel: [ 2223.096608] audit: type=1400 audit(1651006734.198:32): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1923 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:00:02 hostname-pcap kernel: [ 2291.315473] audit: type=1400 audit(1651006802.421:33): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1933 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:01:55 hostname-pcap kernel: [ 2404.315427] audit: type=1400 audit(1651006915.426:34): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1953 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:02:29 hostname-pcap kernel: [ 2438.316675] audit: type=1400 audit(1651006949.432:35): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1960 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:02:40 hostname-pcap kernel: [ 2448.918463] audit: type=1400 audit(1651006960.032:36): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1963 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=0 ouid=0 Apr 26 21:04:15 hostname-pcap kernel: [ 2544.397543] audit: type=1400 audit(1651007055.516:37): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1996 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:04:23 hostname-pcap kernel: [ 2552.557682] audit: type=1400 audit(1651007063.676:38): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1999 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:05:29 hostname-pcap kernel: [ 2618.028858] audit: type=1400 audit(1651007129.151:39): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=2018 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:05:35 hostname-pcap kernel: [ 2624.785708] audit: type=1400 audit(1651007135.907:40): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=2021 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:06:04 hostname-pcap kernel: [ 2653.751938] audit: type=1400 audit(1651007164.877:41): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=2025 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 22:31:05 hostname-pcap kernel: [ 7753.978615] audit: type=1400 audit(1651012265.324:42): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic.pcap1\" pid=2042 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 27 09:52:34 hostname-pcap kernel: [48641.533480] audit: type=1400 audit(1651053154.580:43): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic.pcap1\" pid=3078 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Disable the tcpdump apparmor policy: sudo apparmor_parser -R /etc/apparmor.d/usr.bin.tcpdump Modify the apparmor policy: /etc/apparmor.d/usr.bin.tcpdump # for -r, -F and -w /**.[pP][cC][aA][pP][0-9]* rw, /**.[cC][aA][pP][0-9]* rw, Test/Verify tcpdump can write/create new files. ( NOTE: The policy is not activated yet. We just want to make sure it works while it's still off) Re-enable the tcpdump apparmor policy: sudo apparmor_parser /etc/apparmor.d/usr.bin.tcpdump Test/Verify tcpdump can write/create new files past the initial base filename given when the command was invoked. Reference https://www.xmodulo.com/disable-particular-apparmor-profile-ubuntu.html Links/Reference https://www.tcpdump.org/manpages/pcap-filter.7.html","title":"TCPdump"},{"location":"tcpdump/#tcpdump","text":"","title":"TCPdump"},{"location":"tcpdump/#filters","text":"Filters are written in BPF (Berkley Packet Filter).","title":"Filters"},{"location":"tcpdump/#cdp-vtp-pagp-dtp-rstp","text":"'ether dst 01:00:0c:cc:cc:cd'","title":"CDP, VTP, PAgP, DTP, RSTP"},{"location":"tcpdump/#eigrp","text":"'ether dst 01:00:5e:00:00:0a' 'host 224.0.0.10'","title":"EIGRP"},{"location":"tcpdump/#spanning-tree","text":"'stp'","title":"Spanning-Tree"},{"location":"tcpdump/#vlans-8021q","text":"vlan","title":"VLANs / 802.1q"},{"location":"tcpdump/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"tcpdump/#continuous-capture-failing-to-write-to-new-file","text":"sudo tcpdump -i ens160 -C 100 -w web_traffic.pcap When tcpdump writes continuous files it appends a number to the file name. If you wanted to continuously capture traffic and write it to disks in approximately 100MB files using the base filename full_capture.pcap . Once the first ~100MB is written, tcpdump will create a new file with the name: full_capture.pcap1 . This will continue, increasing the numeric value appended to the end. The conflict with the apparmor policy happens because apparmor will only allow tcpdump to write files with extensions: .pcap or .cap (in any combination of upper- and lowercase). The problem is this section of the apparmor policy: /etc/apparmor.d/usr.bin.tcpdump # for -r, -F and -w /**.[pP][cC][aA][pP] rw, /**.[cC][aA][pP] rw, We can modify the policy to allow the continuous writing of files by adding the below lines or modifying the existing lines from the config section above: # for -r, -F and -w /**.[pP][cC][aA][pP][0-9]* rw, /**.[cC][aA][pP][0-9]* rw,","title":"Continuous capture failing to write to new file"},{"location":"tcpdump/#solution","text":"My solution isn't to disable apparmor, but instead to modify the apparmor policy so tcpdump can do what it needs and apparmor can continue to do what it does.","title":"Solution"},{"location":"tcpdump/#commands","text":"Check the apparmor status: sudo aa-status Check the logs: cat /var/log/syslog | grep -i denied Apr 26 20:58:00 hostname-pcap kernel: [ 2169.229999] audit: type=1400 audit(1651006680.331:31): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1905 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 20:58:54 hostname-pcap kernel: [ 2223.096608] audit: type=1400 audit(1651006734.198:32): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1923 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:00:02 hostname-pcap kernel: [ 2291.315473] audit: type=1400 audit(1651006802.421:33): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1933 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:01:55 hostname-pcap kernel: [ 2404.315427] audit: type=1400 audit(1651006915.426:34): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web-traffic\" pid=1953 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:02:29 hostname-pcap kernel: [ 2438.316675] audit: type=1400 audit(1651006949.432:35): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1960 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:02:40 hostname-pcap kernel: [ 2448.918463] audit: type=1400 audit(1651006960.032:36): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1963 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=0 ouid=0 Apr 26 21:04:15 hostname-pcap kernel: [ 2544.397543] audit: type=1400 audit(1651007055.516:37): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1996 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:04:23 hostname-pcap kernel: [ 2552.557682] audit: type=1400 audit(1651007063.676:38): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=1999 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:05:29 hostname-pcap kernel: [ 2618.028858] audit: type=1400 audit(1651007129.151:39): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=2018 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 21:05:35 hostname-pcap kernel: [ 2624.785708] audit: type=1400 audit(1651007135.907:40): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=2021 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=1000 ouid=1000 Apr 26 21:06:04 hostname-pcap kernel: [ 2653.751938] audit: type=1400 audit(1651007164.877:41): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic\" pid=2025 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 26 22:31:05 hostname-pcap kernel: [ 7753.978615] audit: type=1400 audit(1651012265.324:42): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic.pcap1\" pid=2042 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Apr 27 09:52:34 hostname-pcap kernel: [48641.533480] audit: type=1400 audit(1651053154.580:43): apparmor=\"DENIED\" operation=\"mknod\" profile=\"tcpdump\" name=\"/mnt/pcap/web_traffic.pcap1\" pid=3078 comm=\"tcpdump\" requested_mask=\"c\" denied_mask=\"c\" fsuid=109 ouid=109 Disable the tcpdump apparmor policy: sudo apparmor_parser -R /etc/apparmor.d/usr.bin.tcpdump Modify the apparmor policy: /etc/apparmor.d/usr.bin.tcpdump # for -r, -F and -w /**.[pP][cC][aA][pP][0-9]* rw, /**.[cC][aA][pP][0-9]* rw, Test/Verify tcpdump can write/create new files. ( NOTE: The policy is not activated yet. We just want to make sure it works while it's still off) Re-enable the tcpdump apparmor policy: sudo apparmor_parser /etc/apparmor.d/usr.bin.tcpdump Test/Verify tcpdump can write/create new files past the initial base filename given when the command was invoked.","title":"Commands"},{"location":"tcpdump/#reference","text":"https://www.xmodulo.com/disable-particular-apparmor-profile-ubuntu.html","title":"Reference"},{"location":"tcpdump/#linksreference","text":"https://www.tcpdump.org/manpages/pcap-filter.7.html","title":"Links/Reference"},{"location":"tcpreplay/","text":"TCPReplay Basic Usage Troubleshooting Unsupported DLT Type Using the command tcpreplay -i [interface] [filename.pcap] to replay a *.pcap and getting alot of Warnings on the screen: Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) ...etc... While the file I was using openned fine in Wireshark and parsed perfected using tcpdump, it was generating warnings in TCPReplay and I wanted to understand why so I could more reliably replay predicatable traffic. The frames and packets it was flagging with a Warning we all STP, RSTP, ARP and EIGRP. This was a Full-PCAP from a CTF event and contained all protocols. Filtering out those protocols (sans EIGRP IIRC) was the solution. Solution Preparse the PCAPs excluding all non-IP traffic. To do this I used tcpdump: tcpdump -r [in-filename] -w [out-filename] 'ip' Tcpdump will read a *.pcap file, filter all traffic leaving only IP traffic and writing it to a new file. Now, using TCPReplay I could replay the new files without issue or Warning. Reference https://sourceforge.net/p/tcpreplay/mailman/tcpreplay-users/?viewmonth=202204&style=flat Links/References Homepage: http://tcpreplay.appneta.com/ GitHub: https://github.com/appneta/tcpreplay","title":"TCPReplay"},{"location":"tcpreplay/#tcpreplay","text":"","title":"TCPReplay"},{"location":"tcpreplay/#basic-usage","text":"","title":"Basic Usage"},{"location":"tcpreplay/#troubleshooting","text":"","title":"Troubleshooting"},{"location":"tcpreplay/#unsupported-dlt-type","text":"Using the command tcpreplay -i [interface] [filename.pcap] to replay a *.pcap and getting alot of Warnings on the screen: Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) Warning: Unable to process unsupported DLT Type: Ethernet (0x1) ...etc... While the file I was using openned fine in Wireshark and parsed perfected using tcpdump, it was generating warnings in TCPReplay and I wanted to understand why so I could more reliably replay predicatable traffic. The frames and packets it was flagging with a Warning we all STP, RSTP, ARP and EIGRP. This was a Full-PCAP from a CTF event and contained all protocols. Filtering out those protocols (sans EIGRP IIRC) was the solution.","title":"Unsupported DLT Type"},{"location":"tcpreplay/#solution","text":"Preparse the PCAPs excluding all non-IP traffic. To do this I used tcpdump: tcpdump -r [in-filename] -w [out-filename] 'ip' Tcpdump will read a *.pcap file, filter all traffic leaving only IP traffic and writing it to a new file. Now, using TCPReplay I could replay the new files without issue or Warning.","title":"Solution"},{"location":"tcpreplay/#reference","text":"https://sourceforge.net/p/tcpreplay/mailman/tcpreplay-users/?viewmonth=202204&style=flat","title":"Reference"},{"location":"tcpreplay/#linksreferences","text":"Homepage: http://tcpreplay.appneta.com/ GitHub: https://github.com/appneta/tcpreplay","title":"Links/References"},{"location":"zeek/","text":"Zeek Zeek Broker Grab the latest from Zeek Broker's Releases on Github: https://github.com/zeek/broker/releases Required Packages: ( sudo apt install [package] ) cmake build-essential libssl-dev libpython3-dev ./configure make make install","title":"Zeek"},{"location":"zeek/#zeek","text":"","title":"Zeek"},{"location":"zeek/#zeek-broker","text":"Grab the latest from Zeek Broker's Releases on Github: https://github.com/zeek/broker/releases Required Packages: ( sudo apt install [package] ) cmake build-essential libssl-dev libpython3-dev ./configure make make install","title":"Zeek Broker"}]}